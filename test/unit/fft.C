//-----------------------------------------------------------------------bl-
//--------------------------------------------------------------------------
//
// QUESO - a library to support the Quantification of Uncertainty
// for Estimation, Simulation and Optimization
//
// Copyright (C) 2008-2017 The PECOS Development Team
//
// This library is free software; you can redistribute it and/or
// modify it under the terms of the Version 2.1 GNU Lesser General
// Public License as published by the Free Software Foundation.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
// Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public
// License along with this library; if not, write to the Free Software
// Foundation, Inc. 51 Franklin Street, Fifth Floor,
// Boston, MA  02110-1301  USA
//
//-----------------------------------------------------------------------el-

#include "config_queso.h"

#ifdef QUESO_HAVE_CPPUNIT

#include <cppunit/extensions/HelperMacros.h>
#include <cppunit/TestCase.h>

#include <queso/Environment.h>
#include <queso/Fft.h>

#include <iomanip>

namespace QUESOTesting
{

class FFTTest : public CppUnit::TestCase
{
public:
  CPPUNIT_TEST_SUITE(FFTTest);
  CPPUNIT_TEST(test_real_fft_forward);
  CPPUNIT_TEST(test_real_fft_inverse);
  CPPUNIT_TEST(test_complex_fft_forward);
  CPPUNIT_TEST(test_complex_fft_inverse);
  CPPUNIT_TEST_SUITE_END();

  // yes, this is necessary
public:
  void setUp()
  {
    _env.reset(new QUESO::FullEnvironment("","",NULL));
  }

  void test_real_fft_forward()
  {
    QUESO::Fft<double> fft(*_env);

    int size = 233;
    std::vector<double> data(size);
    std::vector<std::complex<double> > result(size);

    // Regression test result
    std::vector<std::complex<double> > actual_result = {
      std::complex<double>(54056,0),
        std::complex<double>(-232.999999999977944753482,17279.67820078860313515179),
        std::complex<double>(-232.9999999999905071490502,8638.268208871630122303031),
        std::complex<double>(-232.9999999999853343979339,5757.099868290005360904615),
        std::complex<double>(-232.9999999999793089955347,4315.991750048993708333001),
        std::complex<double>(-232.9999999999719193510828,3450.907507280790468939813),
        std::complex<double>(-232.9999999999700435182604,2873.834973379822713468457),
        std::complex<double>(-232.9999999999812985151948,2461.340318855926852847915),
        std::complex<double>(-232.9999999999984652276908,2151.706590528156084474176),
        std::complex<double>(-233.0000000000005684341886,1910.646557904279461581609),
        std::complex<double>(-232.99999999998652810973,1717.587851716759587361594),
        std::complex<double>(-232.9999999999708393261244,1559.438935969545809712145),
        std::complex<double>(-232.9999999999585043042316,1427.472093947681059944443),
        std::complex<double>(-232.9999999999675992512493,1315.645036055922901141457),
        std::complex<double>(-232.9999999999658939486835,1219.641818571570183848962),
        std::complex<double>(-232.9999999999872670741752,1136.297394884928735336871),
        std::complex<double>(-233.0000000000005684341886,1063.237960013719202834181),
        std::complex<double>(-232.9999999999961346475175,998.6482323374784755287692),
        std::complex<double>(-232.9999999999931219463178,941.1163080774545051099267),
        std::complex<double>(-232.9999999999980104803399,889.5275090889149396389257),
        std::complex<double>(-233.0000000000006821210263,842.9900763068887954432284),
        std::complex<double>(-232.9999999999909618964011,800.7820936270593392691808),
        std::complex<double>(-232.9999999999879491952015,762.3128870832061920737033),
        std::complex<double>(-232.9999999999947135620459,727.0944937962137828435516),
        std::complex<double>(-233.0000000000046043169277,694.7202636775493829190964),
        std::complex<double>(-233.0000000000212025952351,664.8485967160237350981333),
        std::complex<double>(-233.0000000000218847162614,637.1904331904135005970602),
        std::complex<double>(-233.0000000000271143107966,611.4995238271253583661746),
        std::complex<double>(-233.0000000000163709046319,587.56478491658458551683),
        std::complex<double>(-233.0000000000119939613796,565.2042351219813554052962),
        std::complex<double>(-233.0000000000147792889038,544.2601449189833147102036),
        std::complex<double>(-233.0000000000194404492504,524.5951248460312399402028),
        std::complex<double>(-233.0000000000239310793404,506.0889472005882225857931),
        std::complex<double>(-233.0000000000242721398536,488.6359456012899045163067),
        std::complex<double>(-233.0000000000266027200269,472.1428734437789103139949),
        std::complex<double>(-233.0000000000206341610465,456.5271294711126870424778),
        std::complex<double>(-233.0000000000217141860048,441.7152790751918587375258),
        std::complex<double>(-233.0000000000256079601968,427.6418153799141350646096),
        std::complex<double>(-233.0000000000218847162614,414.2481159355631916696439),
        std::complex<double>(-233.0000000000213162820728,401.481559914437468705728),
        std::complex<double>(-233.0000000000233342234424,389.2947777198619405680802),
        std::complex<double>(-233.0000000000219699813897,377.6450104011626649480604),
        std::complex<double>(-233.0000000000251532128459,366.4935605734718251369486),
        std::complex<double>(-233.0000000000283648660115,355.8053199458573203628475),
        std::complex<double>(-233.0000000000301270119962,345.5483612699502486975689),
        std::complex<double>(-233.0000000000295869995171,335.6935846879425184852153),
        std::complex<double>(-233.000000000026744828574,326.2144102013518249805202),
        std::complex<double>(-233.0000000000269153588306,317.0865093914453609613702),
        std::complex<double>(-233.0000000000284217094304,308.2875706667321082932176),
        std::complex<double>(-233.0000000000270858890872,299.7970932477939527416311),
        std::complex<double>(-233.0000000000272848410532,291.5962058658662954258034),
        std::complex<double>(-233.0000000000251247911365,283.6675067828534793079598),
        std::complex<double>(-233.000000000022851054382,275.9949222623366722473293),
        std::complex<double>(-233.0000000000229078978009,268.563581054273299741908),
        std::complex<double>(-233.0000000000223678853217,261.3597028173365970360464),
        std::complex<double>(-233.0000000000271711542155,254.3704987046504868430929),
        std::complex<double>(-233.00000000002594902071,247.5840825921700343315024),
        std::complex<double>(-233.0000000000268869371212,240.9893916424840654144646),
        std::complex<double>(-233.0000000000248405740422,234.5761150768816492018232),
        std::complex<double>(-233.0000000000201225702767,228.334630181597816545036),
        std::complex<double>(-233.0000000000234763319895,222.2559447038345581404428),
        std::complex<double>(-233.0000000000213447037822,216.3316449039214433014422),
        std::complex<double>(-233.00000000001696776053,210.553848624743466189102),
        std::complex<double>(-233.0000000000190709670278,204.9151628204581925274397),
        std::complex<double>(-233.0000000000206910044653,199.4086450564207666502625),
        std::complex<double>(-233.0000000000222257767746,194.0277685522481760926894),
        std::complex<double>(-233.000000000019610979507,188.7663903917868424287008),
        std::complex<double>(-233.0000000000202646788239,183.6187225686920214684505),
        std::complex<double>(-233.0000000000203499439522,178.57930557521012815414),
        std::complex<double>(-233.0000000000156603618962,173.6429842757750066084554),
        std::complex<double>(-233.0000000000159730006999,168.8048858363534350246482),
        std::complex<double>(-233.0000000000118518528325,164.0603995064374771573057),
        std::complex<double>(-233.0000000000145519152284,159.4051580729964712190849),
        std::complex<double>(-233.0000000000114539489005,154.8350208255175175509066),
        std::complex<double>(-233.0000000000107434061647,150.3460578886570147005841),
        std::complex<double>(-233.0000000000057980287238,145.9345357942809187079547),
        std::complex<double>(-233.0000000000061675109464,141.596904178104580296349),
        std::complex<double>(-233.0000000000081570306065,137.3297834980810989691236),
        std::complex<double>(-233.0000000000089244167611,133.12995368221521630403),
        std::complex<double>(-233.0000000000110560449684,128.9943436227406436955789),
        std::complex<double>(-233.0000000000111697318061,124.9200214419037138213753),
        std::complex<double>(-233.0000000000107718278741,120.9041854619725313568779),
        std::complex<double>(-233.0000000000111697318061,116.9441558185583573958866),
        std::complex<double>(-233.000000000012676082406,113.0373666621948132160469),
        std::complex<double>(-233.0000000000119939613796,109.1813588983800684673042),
        std::complex<double>(-233.000000000009379164112,105.3737734208164056326495),
        std::complex<double>(-233.0000000000115392140287,101.6123447968489301729278),
        std::complex<double>(-233.0000000000119086962513,97.89489536778529554794659),
        std::complex<double>(-233.0000000000086401996668,94.21932973007199052517535),
        std::complex<double>(-233.0000000000082991391537,90.58362956643162533509894),
        std::complex<double>(-233.0000000000127329258248,86.98584879860467822254577),
        std::complex<double>(-233.0000000000162572177942,83.42410903588691439836111),
        std::complex<double>(-233.0000000000188720150618,79.89659529580137586890487),
        std::complex<double>(-233.000000000019610979507,76.40155197518379281973466),
        std::complex<double>(-233.0000000000185309545486,72.93727905176342574122828),
        std::complex<double>(-233.0000000000266027200269,69.50212849796329805940331),
        std::complex<double>(-233.0000000000299564817396,66.09450088999025751945737),
        std::complex<double>(-233.0000000000343334249919,62.71284219673219695323496),
        std::complex<double>(-233.0000000000356408236257,59.35564073402466078732687),
        std::complex<double>(-233.0000000000369482222595,56.02142427102228339208523),
        std::complex<double>(-233.0000000000372608610633,52.70875727635711882612668),
        std::complex<double>(-233.0000000000382556208933,49.41623829257761713051877),
        std::complex<double>(-233.0000000000432009983342,46.14249742825336397800129),
        std::complex<double>(-233.0000000000478621586808,42.8861939577519990507426),
        std::complex<double>(-233.0000000000460431692773,39.64601401942644542941707),
        std::complex<double>(-233.0000000000457021087641,36.4206684034654983861401),
        std::complex<double>(-233.0000000000479758455185,33.20889042119378586903622),
        std::complex<double>(-233.000000000045957904149,30.00943384810992142774921),
        std::complex<double>(-233.000000000044508396968,26.82107093337583592074225),
        std::complex<double>(-233.000000000047151615945,23.64259046876243530732609),
        std::complex<double>(-233.0000000000505337993673,20.47279591049483826736832),
        std::complex<double>(-233.0000000000536601874046,17.31050354768144927675166),
        std::complex<double>(-233.0000000000566160451854,14.15454071124808876902534),
        std::complex<double>(-233.0000000000584350345889,11.00374401758072195889326),
        std::complex<double>(-233.0000000000597424332227,7.856957641189953989169226),
        std::complex<double>(-233.0000000000598845417699,4.713031610944003801932922),
        std::complex<double>(-233.0000000000615898443357,0),
        std::complex<double>(-233.0000000000615898443357,-1.570820124480365009844718),
        std::complex<double>(-233.0000000000598845417699,-4.713031610944003801932922),
        std::complex<double>(-233.0000000000597424332227,-7.856957641189953989169226),
        std::complex<double>(-233.0000000000584350345889,-11.00374401758072195889326),
        std::complex<double>(-233.0000000000566160451854,-14.15454071124808876902534),
        std::complex<double>(-233.0000000000536601874046,-17.31050354768144927675166),
        std::complex<double>(-233.0000000000505337993673,-20.47279591049483826736832),
        std::complex<double>(-233.000000000047151615945,-23.64259046876243530732609),
        std::complex<double>(-233.000000000044508396968,-26.82107093337583592074225),
        std::complex<double>(-233.000000000045957904149,-30.00943384810992142774921),
        std::complex<double>(-233.0000000000479758455185,-33.20889042119378586903622),
        std::complex<double>(-233.0000000000457021087641,-36.4206684034654983861401),
        std::complex<double>(-233.0000000000460431692773,-39.64601401942644542941707),
        std::complex<double>(-233.0000000000478621586808,-42.8861939577519990507426),
        std::complex<double>(-233.0000000000432009983342,-46.14249742825336397800129),
        std::complex<double>(-233.0000000000382556208933,-49.41623829257761713051877),
        std::complex<double>(-233.0000000000372608610633,-52.70875727635711882612668),
        std::complex<double>(-233.0000000000369482222595,-56.02142427102228339208523),
        std::complex<double>(-233.0000000000356408236257,-59.35564073402466078732687),
        std::complex<double>(-233.0000000000343334249919,-62.71284219673219695323496),
        std::complex<double>(-233.0000000000299564817396,-66.09450088999025751945737),
        std::complex<double>(-233.0000000000266027200269,-69.50212849796329805940331),
        std::complex<double>(-233.0000000000185309545486,-72.93727905176342574122828),
        std::complex<double>(-233.000000000019610979507,-76.40155197518379281973466),
        std::complex<double>(-233.0000000000188720150618,-79.89659529580137586890487),
        std::complex<double>(-233.0000000000162572177942,-83.42410903588691439836111),
        std::complex<double>(-233.0000000000127329258248,-86.98584879860467822254577),
        std::complex<double>(-233.0000000000082991391537,-90.58362956643162533509894),
        std::complex<double>(-233.0000000000086401996668,-94.21932973007199052517535),
        std::complex<double>(-233.0000000000119086962513,-97.89489536778529554794659),
        std::complex<double>(-233.0000000000115392140287,-101.6123447968489301729278),
        std::complex<double>(-233.000000000009379164112,-105.3737734208164056326495),
        std::complex<double>(-233.0000000000119939613796,-109.1813588983800684673042),
        std::complex<double>(-233.000000000012676082406,-113.0373666621948132160469),
        std::complex<double>(-233.0000000000111697318061,-116.9441558185583573958866),
        std::complex<double>(-233.0000000000107718278741,-120.9041854619725313568779),
        std::complex<double>(-233.0000000000111697318061,-124.9200214419037138213753),
        std::complex<double>(-233.0000000000110560449684,-128.9943436227406436955789),
        std::complex<double>(-233.0000000000089244167611,-133.12995368221521630403),
        std::complex<double>(-233.0000000000081570306065,-137.3297834980810989691236),
        std::complex<double>(-233.0000000000061675109464,-141.596904178104580296349),
        std::complex<double>(-233.0000000000057980287238,-145.9345357942809187079547),
        std::complex<double>(-233.0000000000107434061647,-150.3460578886570147005841),
        std::complex<double>(-233.0000000000114539489005,-154.8350208255175175509066),
        std::complex<double>(-233.0000000000145519152284,-159.4051580729964712190849),
        std::complex<double>(-233.0000000000118518528325,-164.0603995064374771573057),
        std::complex<double>(-233.0000000000159730006999,-168.8048858363534350246482),
        std::complex<double>(-233.0000000000156603618962,-173.6429842757750066084554),
        std::complex<double>(-233.0000000000203499439522,-178.57930557521012815414),
        std::complex<double>(-233.0000000000202646788239,-183.6187225686920214684505),
        std::complex<double>(-233.000000000019610979507,-188.7663903917868424287008),
        std::complex<double>(-233.0000000000222257767746,-194.0277685522481760926894),
        std::complex<double>(-233.0000000000206910044653,-199.4086450564207666502625),
        std::complex<double>(-233.0000000000190709670278,-204.9151628204581925274397),
        std::complex<double>(-233.00000000001696776053,-210.553848624743466189102),
        std::complex<double>(-233.0000000000213447037822,-216.3316449039214433014422),
        std::complex<double>(-233.0000000000234763319895,-222.2559447038345581404428),
        std::complex<double>(-233.0000000000201225702767,-228.334630181597816545036),
        std::complex<double>(-233.0000000000248405740422,-234.5761150768816492018232),
        std::complex<double>(-233.0000000000268869371212,-240.9893916424840654144646),
        std::complex<double>(-233.00000000002594902071,-247.5840825921700343315024),
        std::complex<double>(-233.0000000000271711542155,-254.3704987046504868430929),
        std::complex<double>(-233.0000000000223678853217,-261.3597028173365970360464),
        std::complex<double>(-233.0000000000229078978009,-268.563581054273299741908),
        std::complex<double>(-233.000000000022851054382,-275.9949222623366722473293),
        std::complex<double>(-233.0000000000251247911365,-283.6675067828534793079598),
        std::complex<double>(-233.0000000000272848410532,-291.5962058658662954258034),
        std::complex<double>(-233.0000000000270858890872,-299.7970932477939527416311),
        std::complex<double>(-233.0000000000284217094304,-308.2875706667321082932176),
        std::complex<double>(-233.0000000000269153588306,-317.0865093914453609613702),
        std::complex<double>(-233.000000000026744828574,-326.2144102013518249805202),
        std::complex<double>(-233.0000000000295869995171,-335.6935846879425184852153),
        std::complex<double>(-233.0000000000301270119962,-345.5483612699502486975689),
        std::complex<double>(-233.0000000000283648660115,-355.8053199458573203628475),
        std::complex<double>(-233.0000000000251532128459,-366.4935605734718251369486),
        std::complex<double>(-233.0000000000219699813897,-377.6450104011626649480604),
        std::complex<double>(-233.0000000000233342234424,-389.2947777198619405680802),
        std::complex<double>(-233.0000000000213162820728,-401.481559914437468705728),
        std::complex<double>(-233.0000000000218847162614,-414.2481159355631916696439),
        std::complex<double>(-233.0000000000256079601968,-427.6418153799141350646096),
        std::complex<double>(-233.0000000000217141860048,-441.7152790751918587375258),
        std::complex<double>(-233.0000000000206341610465,-456.5271294711126870424778),
        std::complex<double>(-233.0000000000266027200269,-472.1428734437789103139949),
        std::complex<double>(-233.0000000000242721398536,-488.6359456012899045163067),
        std::complex<double>(-233.0000000000239310793404,-506.0889472005882225857931),
        std::complex<double>(-233.0000000000194404492504,-524.5951248460312399402028),
        std::complex<double>(-233.0000000000147792889038,-544.2601449189833147102036),
        std::complex<double>(-233.0000000000119939613796,-565.2042351219813554052962),
        std::complex<double>(-233.0000000000163709046319,-587.56478491658458551683),
        std::complex<double>(-233.0000000000271143107966,-611.4995238271253583661746),
        std::complex<double>(-233.0000000000218847162614,-637.1904331904135005970602),
        std::complex<double>(-233.0000000000212025952351,-664.8485967160237350981333),
        std::complex<double>(-233.0000000000046043169277,-694.7202636775493829190964),
        std::complex<double>(-232.9999999999947135620459,-727.0944937962137828435516),
        std::complex<double>(-232.9999999999879491952015,-762.3128870832061920737033),
        std::complex<double>(-232.9999999999909618964011,-800.7820936270593392691808),
        std::complex<double>(-233.0000000000006821210263,-842.9900763068887954432284),
        std::complex<double>(-232.9999999999980104803399,-889.5275090889149396389257),
        std::complex<double>(-232.9999999999931219463178,-941.1163080774545051099267),
        std::complex<double>(-232.9999999999961346475175,-998.6482323374784755287692),
        std::complex<double>(-233.0000000000005684341886,-1063.237960013719202834181),
        std::complex<double>(-232.9999999999872670741752,-1136.297394884928735336871),
        std::complex<double>(-232.9999999999658939486835,-1219.641818571570183848962),
        std::complex<double>(-232.9999999999675992512493,-1315.645036055922901141457),
        std::complex<double>(-232.9999999999585043042316,-1427.472093947681059944443),
        std::complex<double>(-232.9999999999708393261244,-1559.438935969545809712145),
        std::complex<double>(-232.99999999998652810973,-1717.587851716759587361594),
        std::complex<double>(-233.0000000000005684341886,-1910.646557904279461581609),
        std::complex<double>(-232.9999999999984652276908,-2151.706590528156084474176),
        std::complex<double>(-232.9999999999812985151948,-2461.340318855926852847915),
        std::complex<double>(-232.9999999999700435182604,-2873.834973379822713468457),
        std::complex<double>(-232.9999999999719193510828,-3450.907507280790468939813),
        std::complex<double>(-232.9999999999793089955347,-4315.991750048993708333001),
        std::complex<double>(-232.9999999999853343979339,-5757.099868290005360904615),
        std::complex<double>(-232.9999999999905071490502,-8638.268208871630122303031),
        std::complex<double>(-232.999999999977944753482,-17279.67820078860313515179)
    };

    for (int i = 0; i < size; i++) {
      data[i] = 2.0 * i;
    }

    fft.forward(data, size, result);

    for (int i = 0; i < size; i++) {
      CPPUNIT_ASSERT_DOUBLES_EQUAL(actual_result[i].real(), result[i].real(), 1e-14);
      CPPUNIT_ASSERT_DOUBLES_EQUAL(actual_result[i].imag(), result[i].imag(), 1e-14);
    }
  }

  void test_real_fft_inverse()
  {
    QUESO::Fft<double> fft(*_env);

    int size = 233;
    std::vector<double> data(size);
    std::vector<std::complex<double> > result(size);

    // Regression test result
    std::vector<std::complex<double> > actual_result = {
      std::complex<double>(232,0),
      std::complex<double>(-0.9999999999999958921748089,-74.16170901625974920534645),
      std::complex<double>(-1,-37.0741124844274665406374),
      std::complex<double>(-0.9999999999999914512827104,-24.70858312570839387944943),
      std::complex<double>(-1.000000000000002442490654,-18.52356974269982359260212),
      std::complex<double>(-1.000000000000003330669074,-14.81076183382358912865584),
      std::complex<double>(-0.999999999999997113420136,-12.33405567974200423009279),
      std::complex<double>(-0.9999999999999980015985557,-10.56369235560512187532822),
      std::complex<double>(-1.000000000000001554312234,-9.234792234026469870400433),
      std::complex<double>(-0.9999999999999961142194138,-8.200199819331627892893266),
      std::complex<double>(-0.9999999999999987787546729,-7.371621681187792596290365),
      std::complex<double>(-0.9999999999999980015985557,-6.692870969826381966072404),
      std::complex<double>(-0.9999999999999943378625744,-6.126489673595227891667037),
      std::complex<double>(-0.9999999999999885647028464,-5.646545219124142533928534),
      std::complex<double>(-0.9999999999999890087920562,-5.234514242796447724970221),
      std::complex<double>(-0.9999999999999967803532286,-4.876812853583346374364282),
      std::complex<double>(-0.9999999999999965583086237,-4.56325304726904867891335),
      std::complex<double>(-0.999999999999998556710068,-4.286043915611429611089989),
      std::complex<double>(-0.9999999999999963362640187,-4.039125785740044882743405),
      std::complex<double>(-0.9999999999999948929740867,-3.817714631282810522350246),
      std::complex<double>(-0.9999999999999948929740867,-3.617983160115396223943662),
      std::complex<double>(-0.9999999999999987787546729,-3.436833019858628102127796),
      std::complex<double>(-0.9999999999999995559107901,-3.271729129112492806541468),
      std::complex<double>(-1.00000000000000088817842,-3.120577226593199693382985),
      std::complex<double>(-0.9999999999999987787546729,-2.981632032950908950397206),
      std::complex<double>(-1.00000000000000044408921,-2.853427453716910644487825),
      std::complex<double>(-1,-2.734722889229261877375166),
      std::complex<double>(-1.000000000000002886579864,-2.624461475652942077374519),
      std::complex<double>(-1.000000000000000222044605,-2.521737274320137611738346),
      std::complex<double>(-0.9999999999999996669330926,-2.425769249450608011642316),
      std::complex<double>(-0.9999999999999980015985557,-2.335880450296052845970962),
      std::complex<double>(-0.999999999999998556710068,-2.251481222515187230470701),
      std::complex<double>(-1.00000000000000088817842,-2.17205556738452543186213),
      std::complex<double>(-0.9999999999999963362640187,-2.097149981121440909248577),
      std::complex<double>(-0.999999999999998556710068,-2.026364263707242319156876),
      std::complex<double>(-1.000000000000002886579864,-1.959343903309547441082827),
      std::complex<double>(-0.9999999999999990007992778,-1.895773729936491847070101),
      std::complex<double>(-1.000000000000002664535259,-1.835372598197130056263404),
      std::complex<double>(-0.9999999999999987787546729,-1.777888909594782518297507),
      std::complex<double>(-0.9999999999999976685316483,-1.723096823667189303463942),
      std::complex<double>(-0.9999999999999992228438828,-1.670793037424333604690219),
      std::complex<double>(-1.00000000000000044408921,-1.620794036056536935319627),
      std::complex<double>(-0.9999999999999973354647409,-1.572933736366876722456709),
      std::complex<double>(-1.000000000000001776356839,-1.527061458995099707536269),
      std::complex<double>(-1.000000000000001776356839,-1.483040177124261393970528),
      std::complex<double>(-0.9999999999999973354647409,-1.440744998660709486060227),
      std::complex<double>(-0.9999999999999997779553951,-1.400061846357759876013915),
      std::complex<double>(-0.9999999999999981126208581,-1.360886306401068113203223),
      std::complex<double>(-1.000000000000003330669074,-1.323122620887283051871464),
      std::complex<double>(-1.000000000000001776356839,-1.286682803638616201524769),
      std::complex<double>(-0.9999999999999980015985557,-1.251485862085269795684894),
      std::complex<double>(-0.9999999999999965583086237,-1.21745711065604078626734),
      std::complex<double>(-1,-1.184527563357683499489781),
      std::complex<double>(-0.9999999999999998889776975,-1.152633395082740763726292),
      std::complex<double>(-0.9999999999999992228438828,-1.121715462735377810687964),
      std::complex<double>(-0.999999999999997113420136,-1.0917188785607334633454),
      std::complex<double>(-1.000000000000001998401444,-1.062592629150947320937348),
      std::complex<double>(-1,-1.034289234517096200960395),
      std::complex<double>(-0.9999999999999990007992778,-1.006764442390053915232784),
      std::complex<double>(-0.9999999999999980015985557,-0.9799769535691096322693738),
      std::complex<double>(-0.9999999999999983346654631,-0.9538881746945736539444738),
      std::complex<double>(-0.9999999999999965583086237,-0.9284619952958176325452655),
      std::complex<double>(-0.999999999999998556710068,-0.9036645863723246074883377),
      std::complex<double>(-0.9999999999999946709294818,-0.8794642181135842173844708),
      std::complex<double>(-0.9999999999999995559107901,-0.8558310946627661897068151),
      std::complex<double>(-0.9999999999999963362640187,-0.8327372040869075453528581),
      std::complex<double>(-0.9999999999999946709294818,-0.8101561819390173946331402),
      std::complex<double>(-0.9999999999999963362640187,-0.7880631869901101316244763),
      std::complex<double>(-1.000000000000000666133815,-0.7664347878764601329493189),
      std::complex<double>(-0.9999999999999980015985557,-0.7452488595526951531411441),
      std::complex<double>(-0.9999999999999987787546729,-0.7244844885680488122403631),
      std::complex<double>(-0.9999999999999995559107901,-0.7041218862937408395907823),
      std::complex<double>(-0.9999999999999961142194138,-0.6841423093261812526932886),
      std::complex<double>(-1.000000000000001110223025,-0.6645279863756147209485903),
      std::complex<double>(-0.9999999999999978905762532,-0.645262051024278471267337),
      std::complex<double>(-0.9999999999999965583086237,-0.6263284798037852540986137),
      std::complex<double>(-0.9999999999999995559107901,-0.6077120350991529473816399),
      std::complex<double>(-0.9999999999999990007992778,-0.5893982124380990894607635),
      std::complex<double>(-0.9999999999999972244424384,-0.5713731917691313721974211),
      std::complex<double>(-0.9999999999999973354647409,-0.5536237923722222564748563),
      std::complex<double>(-1.00000000000000133226763,-0.5361374310810674836957901),
      std::complex<double>(-0.9999999999999988897769754,-0.5189020835277237120308769),
      std::complex<double>(-0.9999999999999963362640187,-0.5019062481482640114549554),
      std::complex<double>(-0.9999999999999981126208581,-0.4851389127132361700489582),
      std::complex<double>(-0.9999999999999964472863212,-0.4685895231689667372876329),
      std::complex<double>(-0.9999999999999984456877655,-0.4522479545957213131757157),
      std::complex<double>(-0.9999999999999983346654631,-0.4361044841065943589164533),
      std::complex<double>(-0.9999999999999986677323704,-0.4201497655269139097633513),
      std::complex<double>(-0.9999999999999995559107901,-0.4043748057084037839103985),
      std::complex<double>(-0.9999999999999957811525064,-0.3887709423451407020344561),
      std::complex<double>(-1.00000000000000133226763,-0.3733298231699027636132371),
      std::complex<double>(-0.9999999999999966693309261,-0.358043386420033304951005),
      std::complex<double>(-0.9999999999999993338661852,-0.3429038424711656207755084),
      std::complex<double>(-0.9999999999999983346654631,-0.3279036565457582597105102),
      std::complex<double>(-0.999999999999998556710068,-0.3130355324109082015837657),
      std::complex<double>(-0.9999999999999972244424384,-0.2982923969868696567608879),
      std::complex<double>(-0.9999999999999983346654631,-0.2836673857938604159656393),
      std::complex<double>(-0.9999999999999997779553951,-0.2691538291704401175685746),
      std::complex<double>(-0.9999999999999993338661852,-0.2547452392017278133273805),
      std::complex<double>(-0.9999999999999980015985557,-0.2404352973004349192098772),
      std::complex<double>(-0.9999999999999961142194138,-0.2262178423877138633280026),
      std::complex<double>(-0.9999999999999976685316483,-0.2120868596247161008694349),
      std::complex<double>(-1.000000000000006661338148,-0.1980364696490647669069318),
      std::complex<double>(-1.00000000000000044408921,-0.184060918273518586696369),
      std::complex<double>(-0.9999999999999993338661852,-0.1701545666068922935121321),
      std::complex<double>(-0.9999999999999990007992778,-0.156311881559854121137576),
      std::complex<double>(-1.000000000000000666133815,-0.1425274267003060757463828),
      std::complex<double>(-0.999999999999998556710068,-0.1287958534252739428715984),
      std::complex<double>(-0.9999999999999988897769754,-0.1151118924178383406964343),
      std::complex<double>(-0.999999999999998556710068,-0.1014703453594096443923789),
      std::complex<double>(-0.9999999999999995559107901,-0.08786607686899754188214473),
      std::complex<double>(-0.9999999999999975575093458,-0.07429400664232563289424149),
      std::complex<double>(-0.9999999999999953370632966,-0.0607491017649363293506859),
      std::complex<double>(-1.000000000000002664535259,-0.04722636917408785245386937),
      std::complex<double>(-1,-0.03372084824538025549234277),
      std::complex<double>(-0.9999999999999974464870434,-0.02022760348037571861978812),
      std::complex<double>(-0.9999999999999988897769754,-0.006741717272380689553179511),
      std::complex<double>(-0.9999999999999988897769754,0.006741717272380689553179511),
      std::complex<double>(-0.9999999999999974464870434,0.02022760348037571861978812),
      std::complex<double>(-1,0.03372084824538025549234277),
      std::complex<double>(-1.000000000000002664535259,0.04722636917408785245386937),
      std::complex<double>(-0.9999999999999953370632966,0.0607491017649363293506859),
      std::complex<double>(-0.9999999999999975575093458,0.07429400664232563289424149),
      std::complex<double>(-0.9999999999999995559107901,0.08786607686899754188214473),
      std::complex<double>(-0.999999999999998556710068,0.1014703453594096443923789),
      std::complex<double>(-0.9999999999999988897769754,0.1151118924178383406964343),
      std::complex<double>(-0.999999999999998556710068,0.1287958534252739428715984),
      std::complex<double>(-1.000000000000000666133815,0.1425274267003060757463828),
      std::complex<double>(-0.9999999999999990007992778,0.156311881559854121137576),
      std::complex<double>(-0.9999999999999993338661852,0.1701545666068922935121321),
      std::complex<double>(-1.00000000000000044408921,0.184060918273518586696369),
      std::complex<double>(-1.000000000000006661338148,0.1980364696490647669069318),
      std::complex<double>(-0.9999999999999976685316483,0.2120868596247161008694349),
      std::complex<double>(-0.9999999999999961142194138,0.2262178423877138633280026),
      std::complex<double>(-0.9999999999999980015985557,0.2404352973004349192098772),
      std::complex<double>(-0.9999999999999993338661852,0.2547452392017278133273805),
      std::complex<double>(-0.9999999999999997779553951,0.2691538291704401175685746),
      std::complex<double>(-0.9999999999999983346654631,0.2836673857938604159656393),
      std::complex<double>(-0.9999999999999972244424384,0.2982923969868696567608879),
      std::complex<double>(-0.999999999999998556710068,0.3130355324109082015837657),
      std::complex<double>(-0.9999999999999983346654631,0.3279036565457582597105102),
      std::complex<double>(-0.9999999999999993338661852,0.3429038424711656207755084),
      std::complex<double>(-0.9999999999999966693309261,0.358043386420033304951005),
      std::complex<double>(-1.00000000000000133226763,0.3733298231699027636132371),
      std::complex<double>(-0.9999999999999957811525064,0.3887709423451407020344561),
      std::complex<double>(-0.9999999999999995559107901,0.4043748057084037839103985),
      std::complex<double>(-0.9999999999999986677323704,0.4201497655269139097633513),
      std::complex<double>(-0.9999999999999983346654631,0.4361044841065943589164533),
      std::complex<double>(-0.9999999999999984456877655,0.4522479545957213131757157),
      std::complex<double>(-0.9999999999999964472863212,0.4685895231689667372876329),
      std::complex<double>(-0.9999999999999981126208581,0.4851389127132361700489582),
      std::complex<double>(-0.9999999999999963362640187,0.5019062481482640114549554),
      std::complex<double>(-0.9999999999999988897769754,0.5189020835277237120308769),
      std::complex<double>(-1.00000000000000133226763,0.5361374310810674836957901),
      std::complex<double>(-0.9999999999999973354647409,0.5536237923722222564748563),
      std::complex<double>(-0.9999999999999972244424384,0.5713731917691313721974211),
      std::complex<double>(-0.9999999999999990007992778,0.5893982124380990894607635),
      std::complex<double>(-0.9999999999999995559107901,0.6077120350991529473816399),
      std::complex<double>(-0.9999999999999965583086237,0.6263284798037852540986137),
      std::complex<double>(-0.9999999999999978905762532,0.645262051024278471267337),
      std::complex<double>(-1.000000000000001110223025,0.6645279863756147209485903),
      std::complex<double>(-0.9999999999999961142194138,0.6841423093261812526932886),
      std::complex<double>(-0.9999999999999995559107901,0.7041218862937408395907823),
      std::complex<double>(-0.9999999999999987787546729,0.7244844885680488122403631),
      std::complex<double>(-0.9999999999999980015985557,0.7452488595526951531411441),
      std::complex<double>(-1.000000000000000666133815,0.7664347878764601329493189),
      std::complex<double>(-0.9999999999999963362640187,0.7880631869901101316244763),
      std::complex<double>(-0.9999999999999946709294818,0.8101561819390173946331402),
      std::complex<double>(-0.9999999999999963362640187,0.8327372040869075453528581),
      std::complex<double>(-0.9999999999999995559107901,0.8558310946627661897068151),
      std::complex<double>(-0.9999999999999946709294818,0.8794642181135842173844708),
      std::complex<double>(-0.999999999999998556710068,0.9036645863723246074883377),
      std::complex<double>(-0.9999999999999965583086237,0.9284619952958176325452655),
      std::complex<double>(-0.9999999999999983346654631,0.9538881746945736539444738),
      std::complex<double>(-0.9999999999999980015985557,0.9799769535691096322693738),
      std::complex<double>(-0.9999999999999990007992778,1.006764442390053915232784),
      std::complex<double>(-1,1.034289234517096200960395),
      std::complex<double>(-1.000000000000001998401444,1.062592629150947320937348),
      std::complex<double>(-0.999999999999997113420136,1.0917188785607334633454),
      std::complex<double>(-0.9999999999999992228438828,1.121715462735377810687964),
      std::complex<double>(-0.9999999999999998889776975,1.152633395082740763726292),
      std::complex<double>(-1,1.184527563357683499489781),
      std::complex<double>(-0.9999999999999965583086237,1.21745711065604078626734),
      std::complex<double>(-0.9999999999999980015985557,1.251485862085269795684894),
      std::complex<double>(-1.000000000000001776356839,1.286682803638616201524769),
      std::complex<double>(-1.000000000000003330669074,1.323122620887283051871464),
      std::complex<double>(-0.9999999999999981126208581,1.360886306401068113203223),
      std::complex<double>(-0.9999999999999997779553951,1.400061846357759876013915),
      std::complex<double>(-0.9999999999999973354647409,1.440744998660709486060227),
      std::complex<double>(-1.000000000000001776356839,1.483040177124261393970528),
      std::complex<double>(-1.000000000000001776356839,1.527061458995099707536269),
      std::complex<double>(-0.9999999999999973354647409,1.572933736366876722456709),
      std::complex<double>(-1.00000000000000044408921,1.620794036056536935319627),
      std::complex<double>(-0.9999999999999992228438828,1.670793037424333604690219),
      std::complex<double>(-0.9999999999999976685316483,1.723096823667189303463942),
      std::complex<double>(-0.9999999999999987787546729,1.777888909594782518297507),
      std::complex<double>(-1.000000000000002664535259,1.835372598197130056263404),
      std::complex<double>(-0.9999999999999990007992778,1.895773729936491847070101),
      std::complex<double>(-1.000000000000002886579864,1.959343903309547441082827),
      std::complex<double>(-0.999999999999998556710068,2.026364263707242319156876),
      std::complex<double>(-0.9999999999999963362640187,2.097149981121440909248577),
      std::complex<double>(-1.00000000000000088817842,2.17205556738452543186213),
      std::complex<double>(-0.999999999999998556710068,2.251481222515187230470701),
      std::complex<double>(-0.9999999999999980015985557,2.335880450296052845970962),
      std::complex<double>(-0.9999999999999996669330926,2.425769249450608011642316),
      std::complex<double>(-1.000000000000000222044605,2.521737274320137611738346),
      std::complex<double>(-1.000000000000002886579864,2.624461475652942077374519),
      std::complex<double>(-1,2.734722889229261877375166),
      std::complex<double>(-1.00000000000000044408921,2.853427453716910644487825),
      std::complex<double>(-0.9999999999999987787546729,2.981632032950908950397206),
      std::complex<double>(-1.00000000000000088817842,3.120577226593199693382985),
      std::complex<double>(-0.9999999999999995559107901,3.271729129112492806541468),
      std::complex<double>(-0.9999999999999987787546729,3.436833019858628102127796),
      std::complex<double>(-0.9999999999999948929740867,3.617983160115396223943662),
      std::complex<double>(-0.9999999999999948929740867,3.817714631282810522350246),
      std::complex<double>(-0.9999999999999963362640187,4.039125785740044882743405),
      std::complex<double>(-0.999999999999998556710068,4.286043915611429611089989),
      std::complex<double>(-0.9999999999999965583086237,4.56325304726904867891335),
      std::complex<double>(-0.9999999999999967803532286,4.876812853583346374364282),
      std::complex<double>(-0.9999999999999890087920562,5.234514242796447724970221),
      std::complex<double>(-0.9999999999999885647028464,5.646545219124142533928534),
      std::complex<double>(-0.9999999999999943378625744,6.126489673595227891667037),
      std::complex<double>(-0.9999999999999980015985557,6.692870969826381966072404),
      std::complex<double>(-0.9999999999999987787546729,7.371621681187792596290365),
      std::complex<double>(-0.9999999999999961142194138,8.200199819331627892893266),
      std::complex<double>(-1.000000000000001554312234,9.234792234026469870400433),
      std::complex<double>(-0.9999999999999980015985557,10.56369235560512187532822),
      std::complex<double>(-0.999999999999997113420136,12.33405567974200423009279),
      std::complex<double>(-1.000000000000003330669074,14.81076183382358912865584),
      std::complex<double>(-1.000000000000002442490654,18.52356974269982359260212),
      std::complex<double>(-0.9999999999999914512827104,24.70858312570839387944943),
      std::complex<double>(-1,37.0741124844274665406374),
      std::complex<double>(-0.9999999999999958921748089,74.16170901625974920534645)
    };

    for (int i = 0; i < size; i++) {
      data[i] = 2.0 * i;
    }

    fft.inverse(data, size, result);

    for (int i = 0; i < size; i++) {
      CPPUNIT_ASSERT_DOUBLES_EQUAL(actual_result[i].real(), result[i].real(), 1e-14);
      CPPUNIT_ASSERT_DOUBLES_EQUAL(actual_result[i].imag(), result[i].imag(), 1e-14);
    }
  }

  void test_complex_fft_forward()
  {
    // Not implemented in QUESO
  }

  void test_complex_fft_inverse()
  {
    // Not implemented in QUESO
  }

private:
  typename QUESO::ScopedPtr<QUESO::BaseEnvironment>::Type _env;
};

CPPUNIT_TEST_SUITE_REGISTRATION(FFTTest);

} // end namespace QUESOTesting

#endif // QUESO_HAVE_CPPUNIT
